plot1 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarize(m = mean(payroll), n=mean(winPercentage))%>%
ggplot(mapping=aes(x=m, y=n, col = ifelse(teamID=="OAK", "Oakland", "Other"))) +
geom_point() +
geom_smooth(method=lm) +
labs(color='NEW LEGEND TITLE') +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
scale_x_continuous(labels = scales::dollar)
plot1+facet_wrap(~yearRange, nrow = 3, ncol = 2)
payroll_df$yearRange <- cut(payroll_df$yearID, breaks=5)
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
plot1 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarize(m = mean(payroll), n=mean(winPercentage))%>%
ggplot(mapping=aes(x=m, y=n, col = ifelse(teamID=="OAK", "Oakland", "Other"))) +
geom_point() +
geom_smooth(method=lm) +
labs(color='Team Colors') +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
scale_x_continuous(labels = scales::dollar)
plot1+facet_wrap(~yearRange, nrow = 3, ncol = 2)
payroll_df %>%
filter(teamID %in% c("OAK", "BOS", "BAL", "NYA", "ATL", "TBA")) %>%
ggplot(mapping = aes(x=yearID, y=efficiency, color = teamID)) +
geom_smooth() +
geom_point() +
labs(color='Team Colors')
# make sure you write the path to your sqlite path here
db <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(dplyr)
library(tidyr)
library(ggplot2)
payroll_df %>%
head()
payroll_df %>%
group_by(yearID) %>%
filter(1990 <= yearID & yearID <= 2014) %>%
ggplot(mapping=aes(y=payroll, x=factor(yearID))) +
geom_boxplot() +
xlab("Year") +
ylab("Payroll") +
ggtitle("Payroll vs Year 1990 - 2014") +
scale_y_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins=100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange, as.table = FALSE)
payroll_df$yearRange <- cut(payroll_df$yearID, breaks=5)
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
plot1 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarize(m = mean(payroll), n=mean(winPercentage))%>%
ggplot(mapping=aes(x=m, y=n, col = ifelse(teamID=="OAK", "Oakland", "Other"))) +
geom_point() +
geom_smooth(method=lm) +
labs(color='Team Colors') +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
scale_x_continuous(labels = scales::dollar)
plot1+facet_wrap(~yearRange, nrow = 3, ncol = 2)
payroll_df <- payroll_df %>%
group_by(yearID) %>%
mutate(standardized_payroll = (payroll-mean(payroll))/sd(payroll))
payroll_df[,c(5:8)]
plot5 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarise(n = mean(standardized_payroll), m = mean(winPercentage)) %>%
ggplot(aes(x=n, y=m)) +
geom_point() +
geom_text(aes(label=teamID),hjust=0, vjust=0) +
geom_smooth(method=lm) +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
plot5+facet_wrap(~yearRange)
payroll_df %>%
ggplot(mapping = aes(x=standardized_payroll, y = winPercentage)) +
geom_point() +
geom_smooth(method = lm)
payroll_df <- payroll_df %>%
mutate(expected_win_pct = (50 + 2.5 * standardized_payroll)) %>%
mutate(efficiency = winPercentage - expected_win_pct)
payroll_df
payroll_df %>%
filter(teamID %in% c("OAK", "BOS", "BAL", "NYA", "ATL", "TBA")) %>%
ggplot(mapping = aes(x=yearID, y=efficiency, color = teamID)) +
geom_smooth() +
geom_point() +
labs(color='Team Colors')
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins=100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange, as.table = FALSE)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins=100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
plot1+facet_wrap(~yearRange, as.table = FALSE)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins=100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
plot1+facet_wrap(~yearRange, as.table = FALSE)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins=100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange, as.table = FALSE)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_line() +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange, as.table = FALSE)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram() +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange, as.table = FALSE)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins = 100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins = 100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins = 100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins = 100) +
scale_x_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab("Pay") +
ylab("# of Teams") +
ggtitle("Average Yearly Payroll vs Mode of Payroll")
plot1+facet_wrap(~yearRange)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=payroll)) +
geom_histogram(bins = 100)
plot1+facet_wrap(~yearRange)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange) %>%
ggplot(mapping=aes(x=factor(payroll))) +
geom_histogram(bins = 100)
plot1+facet_wrap(~yearRange)
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange)
plot1
plot1 <- payroll_df %>%
filter(1990 <= yearID & yearID <=2014) %>%
mutate(yearRange = cut(yearID, breaks=5)) %>%
group_by(yearRange)
plot1
# make sure you write the path to your sqlite path here
db <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(dplyr)
library(tidyr)
library(ggplot2)
payroll_df %>%
head()
payroll_df %>%
group_by(yearID) %>%
filter(1990 <= yearID & yearID <= 2014) %>%
ggplot(mapping=aes(y=payroll, x=factor(yearID))) +
geom_boxplot() +
xlab("Year") +
ylab("Payroll") +
ggtitle("Payroll vs Year 1990 - 2014") +
scale_y_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# make sure you write the path to your sqlite path here
db <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(dplyr)
library(tidyr)
library(ggplot2)
payroll_df %>%
head()
payroll_df %>%
group_by(yearID) %>%
filter(1990 <= yearID & yearID <= 2014) %>%
ggplot(mapping=aes(y=payroll, x=factor(yearID))) +
geom_boxplot() +
xlab("Year") +
ylab("Payroll") +
ggtitle("Payroll vs Year 1990 - 2014") +
scale_y_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
payroll_df$yearRange <- cut(payroll_df$yearID, breaks=5)
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
plot1 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarize(m = mean(payroll), n=mean(winPercentage))%>%
ggplot(mapping=aes(x=m, y=n, col = ifelse(teamID=="OAK", "Oakland", "Other"))) +
geom_point() +
geom_smooth(method=lm) +
labs(color='Team Colors') +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
scale_x_continuous(labels = scales::dollar) +
xlab(label="Win Percentage") +
ylab(label="Average Payroll") +
ggtitle("Average Payroll vs Win Percentage")
plot1+facet_wrap(~yearRange, nrow = 3, ncol = 2)
payroll_df <- payroll_df %>%
group_by(yearID) %>%
mutate(standardized_payroll = (payroll-mean(payroll))/sd(payroll))
payroll_df[,c(5:8)]
plot5 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarise(n = mean(standardized_payroll), m = mean(winPercentage)) %>%
ggplot(aes(x=n, y=m)) +
geom_point() +
geom_text(aes(label=teamID),hjust=0, vjust=0) +
geom_smooth(method=lm) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab(label="Standardized Payroll") +
ylab(label="Win Percentage") +
ggtitle("Standardized Payroll vs Win Percentage for 5 Time Periods in 1990-2014")
plot5+facet_wrap(~yearRange)
payroll_df %>%
ggplot(mapping = aes(x=standardized_payroll, y = winPercentage)) +
geom_point() +
geom_smooth(method = lm)+
xlab(label="Standardized Payroll") +
ylab(label="Win Percentage") +
ggtitle("Standardized Payroll vs Win Percentage for All Teams & All Years")
payroll_df <- payroll_df %>%
mutate(expected_win_pct = (50 + 2.5 * standardized_payroll)) %>%
mutate(efficiency = winPercentage - expected_win_pct)
payroll_df
payroll_df %>%
filter(teamID %in% c("OAK", "BOS", "BAL", "NYA", "ATL", "TBA")) %>%
ggplot(mapping = aes(x=yearID, y=efficiency, color = teamID)) +
geom_smooth() +
geom_point() +
labs(color='Team Colors') +
xlab(label="Year") +
ylab(label="Efficiency")
# make sure you write the path to your sqlite path here
db <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(dplyr)
library(tidyr)
library(ggplot2)
payroll_df %>%
head()
payroll_df %>%
group_by(yearID) %>%
filter(1990 <= yearID & yearID <= 2014) %>%
ggplot(mapping=aes(y=payroll, x=factor(yearID))) +
geom_boxplot() +
xlab("Year") +
ylab("Payroll") +
ggtitle("Payroll vs Year 1990 - 2014") +
scale_y_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
plot1 <- payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRage) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100)
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRage) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100)
# make sure you write the path to your sqlite path here
db <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(dplyr)
library(tidyr)
library(ggplot2)
payroll_df %>%
head()
payroll_df %>%
group_by(yearID) %>%
filter(1990 <= yearID & yearID <= 2014) %>%
ggplot(mapping=aes(y=payroll, x=factor(yearID))) +
geom_boxplot() +
xlab("Year") +
ylab("Payroll") +
ggtitle("Payroll vs Year 1990 - 2014") +
scale_y_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRange) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100)
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRange) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100)
plot1 + facet_wrap(~yearRange)
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRange) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100)
plot1 + facet_wrap(~yearRange)
# make sure you write the path to your sqlite path here
db <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(dplyr)
library(tidyr)
library(ggplot2)
payroll_df %>%
head()
payroll_df %>%
group_by(yearID) %>%
filter(1990 <= yearID & yearID <= 2014) %>%
ggplot(mapping=aes(y=payroll, x=factor(yearID))) +
geom_boxplot() +
xlab("Year") +
ylab("Payroll") +
ggtitle("Payroll vs Year 1990 - 2014") +
scale_y_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRange) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100)
plot1 + facet_wrap(~yearRange)
payroll_df$yearRange <- cut(payroll_df$yearID, breaks=5)
plot1 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarize(m = mean(payroll), n=mean(winPercentage))%>%
ggplot(mapping=aes(x=m, y=n, col = ifelse(teamID=="OAK", "Oakland", "Other"))) +
geom_point() +
geom_smooth(method=lm) +
labs(color='Team Colors') +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
scale_x_continuous(labels = scales::dollar) +
xlab(label="Win Percentage") +
ylab(label="Average Payroll") +
ggtitle("Average Payroll vs Win Percentage")
plot1+facet_wrap(~yearRange, nrow = 3, ncol = 2)
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
plot1 <- payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRange) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100)
plot1 + facet_wrap(~yearRange)
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
plot1 <- payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRange) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100) +
scale_x_continuous(labels = scales::dollar) +
xlab(label = "Payroll") +
ylab(label="Count")+
ggtitle("Mode of Payroll for 5 Year Periods of 1990-2014")
plot1 + facet_wrap(~yearRange)
# make sure you write the path to your sqlite path here
db <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(dplyr)
library(tidyr)
library(ggplot2)
payroll_df %>%
head()
payroll_df %>%
group_by(yearID) %>%
filter(1990 <= yearID & yearID <= 2014) %>%
ggplot(mapping=aes(y=payroll, x=factor(yearID))) +
geom_boxplot() +
xlab("Year") +
ylab("Payroll") +
ggtitle("Payroll vs Year 1990 - 2014") +
scale_y_continuous(labels = scales::dollar) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
payroll_df <- filter(payroll_df, 1990 <= yearID & yearID <= 2014)
plot1 <- payroll_df %>%
mutate(yearRange = cut(payroll_df$yearID, breaks = 5)) %>%
group_by(yearRange) %>%
ggplot(mapping = aes(x=payroll)) +
geom_histogram(bins = 100) +
scale_x_continuous(labels = scales::dollar) +
xlab(label = "Payroll") +
ylab(label="Count")+
ggtitle("Mode of Payroll for 5 Year Periods of 1990-2014")
plot1 + facet_wrap(~yearRange)
payroll_df$yearRange <- cut(payroll_df$yearID, breaks=5)
plot1 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarize(m = mean(payroll), n=mean(winPercentage))%>%
ggplot(mapping=aes(x=m, y=n, col = ifelse(teamID=="OAK", "Oakland", "Other"))) +
geom_point() +
geom_smooth(method=lm) +
labs(color='Team Colors') +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
scale_x_continuous(labels = scales::dollar) +
ylab(label="Win Percentage") +
xlab(label="Average Payroll") +
ggtitle("Average Payroll vs Win Percentage")
plot1+facet_wrap(~yearRange, nrow = 3, ncol = 2)
payroll_df <- payroll_df %>%
group_by(yearID) %>%
mutate(standardized_payroll = (payroll-mean(payroll))/sd(payroll))
payroll_df[,c(5:8)]
payroll_df$yearRange <- cut(payroll_df$yearID, breaks=5)
plot1 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarize(m = mean(payroll), n=mean(winPercentage))%>%
ggplot(mapping=aes(x=m, y=n, col = ifelse(teamID=="OAK", "Oakland", "Other"))) +
geom_point() +
geom_smooth(method=lm) +
labs(color='Team Colors') +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
scale_x_continuous(labels = scales::dollar) +
ylab(label="Win Percentage") +
xlab(label="Average Payroll") +
ggtitle("Average Payroll vs Win Percentage")
plot1+facet_wrap(~yearRange, nrow = 3, ncol = 2)
plot5 <- payroll_df %>%
group_by(teamID, yearRange) %>%
summarise(n = mean(standardized_payroll), m = mean(winPercentage)) %>%
ggplot(aes(x=n, y=m)) +
geom_point() +
geom_text(aes(label=teamID),hjust=0, vjust=0) +
geom_smooth(method=lm) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
xlab(label="Standardized Payroll") +
ylab(label="Win Percentage") +
ggtitle("Standardized Payroll vs Win Percentage for 5 Time Periods in 1990-2014")
plot5+facet_wrap(~yearRange)
